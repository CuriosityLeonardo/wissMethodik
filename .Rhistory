sqft_lot15,
sqft_above,
sqft_basement))
# attach the data to address the data in an easier way
attach(house_prices_sqmt)
inspect(house_prices_sqmt)
summary(house_prices_sqmt)
### Analyse independent variables with dependent variable price in a 2 dimensional linear regression (p.81-82)
# smqt_living15 and price
#is not running because it takes too much compute power (too many variables and observations)
#regression <- step(lm(data = house_prices_sqmt,price~.),trace=1,steps=2)
## Ecample for Step Regression with all the available Variables
# regression <- step(lm(data = swiss,Fertility~.),trace=1,steps=2)
summary(regression)
help("house_prices")
backward_regression <- step(lm(data=house_prices_sqmt,price~zipcode),direction="backward")
summary(backward_regression)
### Analyse independent variables with dependent variable price in a 2 dimensional linear regression (p.81-82)
# smqt_living15 and price
cor(price,sqmt_living15)
sd(price)
sd(sqmt_living15)
Regressionsgewicht_price_sqmt_living15 <- cor(price,sqmt_living15) * (sd(price)/sd(sqmt_living15))
Regressionsgewicht_price_sqmt_living15
Intercept_price_sqmt_living15 <- mean(price) - Regressionsgewicht_price_sqmt_living15 * mean(sqmt_living15)
Intercept_price_sqmt_living15
Regressionsgewicht_price_sqmt_living15
# Interpretation: Wenn die Wohnfläche bis auf 0m² reduziert worden wäre, würde das Haus -82807.2 Dollar kosten
lm(data=house_prices_sqmt,price~sqmt_living15)
inspect(house_prices_sqmt)
lm(data=house_prices_sqmt,price~date)
summary(lm(data=house_prices_sqmt,price~date))
step(lm(data=house_prices_sqmt,price~bedrooms,bathrooms,floors,view))
step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view))
regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view))
summary(regression)
regression <- step(lm(data=house_prices_sqmt,price~bedrooms))
summary(regression)
regression <- step(lm(data=house_prices_sqmt,price~view))
summary(regression)
inspect(house_prices_sqmt)
regression <- step(lm(data=house_prices_sqmt,price~bedrooms,bathromms,floors,view,yr_built,yr_renovated,sqmt_living15,sqmt_lot15,sqmt_above,sqmt_basement))
regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathromms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
summary(regression)
manual_regression <- lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
summary(manual_regression)
summary(step_regression)
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
summary(step_regression)
# remove all objects from workspace
# Source: https://rstudio-pubs-static.s3.amazonaws.com/155304_cc51f448116744069664b35e7762999f.html
rm(list = ls())
detach("package:moderndive", unload=TRUE)
# Install package moderndive that includes the dataset "house_prices" before adding the library
library(moderndive)
library(mosaic)
# add variables squaremeter to get a more intuitive understanding of the size
house_prices$sqmt_living <- house_prices$sqft_living*0.092903
house_prices$sqmt_living15 <- house_prices$sqft_living15*0.092903
house_prices$sqmt_lot <- house_prices$sqft_lot*0.092903
house_prices$sqmt_lot15 <- house_prices$sqft_lot15*0.092903
house_prices$sqmt_above <- house_prices$sqft_above*0.092903
house_prices$sqmt_basement <- house_prices$sqft_basement*0.092903
# drop the variables with sqft
house_prices_sqmt <- subset(house_prices, select = -c(sqft_living,
sqft_living15,
sqft_lot,
sqft_lot15,
sqft_above,
sqft_basement))
# attach the data to address the data in an easier way
attach(house_prices_sqmt)
inspect(house_prices_sqmt)
# Perform t Test on dependent variable price and independent variable sqft_living15
#t.test(price,sqft_living15) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 1"
regression1 <- lm(data = house_prices_sqmt,price~sqmt_living15)
summary(regression1)
regression1 <- lm(data = house_prices_sqmt,price~sqmt_lot15)
summary(regression1)
regression1 <- lm(data = house_prices_sqmt,price~long)
summary(regression1)
# Perform t Test on dependent variable price and independent variable sqft_lot15
t.test(price,sqft_lot15) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 2"
# Perform t Test on dependent variable price and independent variable bedrooms
t.test(price,bedrooms,data = house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.1"
# Perform t Test on dependent variable price and independent variable bathrooms
t.test(price,bathrooms,data=house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.2"
# Perform t Test on dependent variable price and independent variable floors
t.test(price,floors,data=house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.2"
summary(house_prices_sqmt)
install.packages("corrplot")
library(corrplot)
subset_house_prices_sqmt <- subset(house_prices, select = c(price,
bedrooms,
bathrooms,
floors,
view,
yr_built,
yr_renovated,
lat,
long,
sqmt_living,
sqmt_living15,
sqmt_lot,
sqmt_lot15,
sqmt_above,
sqmt_basement))
?subse
cor_matrix <- cor(subset_house_prices_sqmt[1:15])
cor(subset_house_prices_sqmt[1:15])
cor(lat,price)
corrplot(cor_matrix,type="upper")
inspect(house_prices_sqmt)
View(house_prices_sqmt)
?cor
corrplot(cor_matrix,type="upper")
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
summary(step_regression)
cor(price,bathrooms)
summary(lm(data=house_prices_sqmt,price~bathrooms))
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
summary(step_regression)
manual_regression <- lm(data=house_prices_sqmt,price~bathrooms+floors+view+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
summary(manual_regression)
manual_regression <- lm(data=house_prices_sqmt,price~bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
summary(manual_regression)
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
summary(step_regression)
manual_regression <- lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement))
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement),direction="backward")
summary(step_regression)
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement),direction="backward")
summary(step_regression)
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement),direction="forward")
summary(step_regression)
cor(sqmt_living,sqmt_living15)
cor(sqmt_living,price)
cor(floors,bedrooms)
cor(bathrooms,bedrooms)
lm(data=house_prices_sqmt,bedrooms~bathrooms)
summary(lm(data=house_prices_sqmt,bedrooms~bathrooms))
manual_regression <- lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
summary(step_regression)
cor(bathrooms,bedrooms)
manual_regression <- lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement)
summary(step_regression)
inspect(house_prices_sqmt)
# Alle Variablen, die nicht zur multiplen linearen Regression geeignet sind entfernen
house_prices_sqmt_r <- subset(house_prices, select = -c(id,
waterfront,
condition,
grade,
zipcode,
lat,
long,
date,
sqmt_living,
sqmt_lot
))
attach(house_prices_r)
attach(house_prices_sqmt_r)
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
step(lm(data=house_prices_sqmt_r,price~.))
# Alle Variablen, die nicht zur multiplen linearen Regression geeignet sind entfernen
house_prices_sqmt_r <- subset(house_prices, select = -c(id,
waterfront,
condition,
grade,
zipcode,
lat,
long,
date,
sqmt_living,
sqmt_lot,
view
))
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
step(lm(data=house_prices_sqmt_r,price~.))
summary(step(lm(data=house_prices_sqmt_r,price~.)))
step_regression <- step(lm(data=house_prices_sqmt,price~bedrooms+bathrooms+floors+yr_built+yr_renovated+sqmt_living15+sqmt_lot15+sqmt_above+sqmt_basement),direction="forward")
summary(step_regression)
inspect(house_prices_sqmt_r)
# Alle Variablen, die nicht zur multiplen linearen Regression geeignet sind entfernen
house_prices_sqmt_r <- subset(house_prices, select = -c(id,
waterfront,
condition,
grade,
zipcode,
lat,
long,
date,
sqmt_living,
sqmt_lot,
view
))
inspect(house_prices_sqmt_r)
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(bedrooms,
bathrooms,
sqft_living15,
sqft_lot15,
floors,
sqft_above,
sqft_basement,
yr_built,
yr_renovated,
sqmt_lot,
view
))
attach(house_prices_sqmt_r)
inspect(house_prices_sqmt_r)
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqft_living15,
sqft_lot15,
floors,
sqft_above,
sqft_basement,
yr_built,
yr_renovated,
sqmt_lot,
view
))
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
inspect(house_prices_sqmt_r)
summary(step(lm(data=house_prices_sqmt_r,price~.)))
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqft_living15,
sqft_lot15,
floors,
sqft_above,
sqft_basement,
yr_built,
yr_renovated
))
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
inspect(house_prices_sqmt_r)
summary(step(lm(data=house_prices_sqmt_r,price~.)))
# Korrelationsmatrix von house_prices_sqmt_r erstellen um auf Multikolinearität zu prüfen
korr_hp <- cor(house_prices_sqmt_r)
korr_hp
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqft_living15,
sqft_lot15,
floors,
sqmt_above,
sqmt_basement,
yr_built,
yr_renovated
))
# Add a sqmt_basement/sqmt_above ratio to see if houses with relatively higher ratio of basement sqmt get a higher salesprice
house_prices_sqmt_r$sqmt_basement_above_ratio <- house_prices_sqmt_r$sqmt_above
# Add a sqmt_basement/sqmt_above ratio to see if houses with relatively higher ratio of basement sqmt get a higher salesprice
house_prices_sqmt_r$sqmt_basement_above_ratio <- house_prices_sqmt_r$sqmt_basement/house_prices_sqmt_r$sqmt_above
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
inspect(house_prices_sqmt_r)
# Korrelationsmatrix von house_prices_sqmt_r erstellen um auf Multikolinearität zu prüfen
korr_hp <- cor(house_prices_sqmt_r)
korr_hp
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqft_living15,
sqft_lot15,
floors,
sqmt_above,
sqmt_basement,
yr_built,
yr_renovated
))
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqmt_living15,
sqmt_lot15,
floors,
sqmt_above,
sqmt_basement,
yr_built,
yr_renovated
))
detach(house_prices_sqmt)
attach(house_prices_sqmt_r)
inspect(house_prices_sqmt_r)
# Wähle die Variablen, die zur Multiplen, linearen Regression verwendet werden sollen
house_prices_sqmt_r <- subset(house_prices, select =  c(price,
bedrooms,
bathrooms,
sqmt_living15,
sqmt_lot15,
floors,
sqmt_above,
sqmt_basement,
yr_built,
yr_renovated
))
# Korrelationsmatrix von house_prices_sqmt_r erstellen um auf Multikolinearität zu prüfen
cor(house_prices_sqmt_r)
manual_regression <- lm(data=house_prices_sqmt_r,price~.)
summary(manual_regression)
manual_regression <- lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_above
+sqmt_basement
+yr_built
+yr_renovated)
summary(manual_regression)
+yr_renovated),direction="forward"
summary(step_forward)
step_forward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_above
+sqmt_basement
+yr_built
+yr_renovated),direction="forward")
summary(step_forward)
step_forward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_above
+sqmt_basement
+yr_built
+yr_renovated),direction="forward")
summary(step_forward)
step_backward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_above
+sqmt_basement
+yr_built
+yr_renovated),direction="backward")
summary(step_backward)
step_both <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_above
+sqmt_basement
+yr_built
+yr_renovated),direction="both")
summary(step_both)
manual_regression <- lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated)
summary(manual_regression)
step_forward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="forward")
summary(step_forward)
step_backward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="backward")
summary(step_backward)
step_backward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="backward")
summary(step_backward)
?step
step_backward <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="backward",trace=0)
summary(step_backward)
step_both <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="both")
summary(step_both)
step_both <- step(lm(data=house_prices_sqmt_r,price~
bedrooms
+bathrooms
+sqmt_living15
+sqmt_lot15
+floors
+sqmt_basement
+yr_built
+yr_renovated),direction="both",trace=0)
summary(step_both)
# remove all objects from workspace
# Source: https://rstudio-pubs-static.s3.amazonaws.com/155304_cc51f448116744069664b35e7762999f.html
rm(list = ls())
detach("package:moderndive", unload=TRUE)
# Install package moderndive that includes the dataset "house_prices" before adding the library
library(moderndive)
library(mosaic)
# add variables squaremeter to get a more intuitive understanding of the size
house_prices$sqmt_living <- house_prices$sqft_living*0.092903
house_prices$sqmt_living15 <- house_prices$sqft_living15*0.092903
house_prices$sqmt_lot <- house_prices$sqft_lot*0.092903
house_prices$sqmt_lot15 <- house_prices$sqft_lot15*0.092903
house_prices$sqmt_above <- house_prices$sqft_above*0.092903
house_prices$sqmt_basement <- house_prices$sqft_basement*0.092903
# drop the variables with sqft
house_prices_sqmt <- subset(house_prices, select = -c(sqft_living,
sqft_living15,
sqft_lot,
sqft_lot15,
sqft_above,
sqft_basement))
# attach the data to address the data in an easier way
attach(house_prices_sqmt)
inspect(house_prices_sqmt)
# Perform t Test on dependent variable price and independent variable sqft_living15
#t.test(price,sqft_living15) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 1"
regression1 <- lm(data = house_prices_sqmt,price~sqmt_living15)
summary(regression1)
regression1 <- lm(data = house_prices_sqmt,price~sqmt_lot15)
summary(regression1)
regression1 <- lm(data = house_prices_sqmt,price~long)
summary(regression1)
# Perform t Test on dependent variable price and independent variable sqft_lot15
t.test(price,sqft_lot15) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 2"
# Perform t Test on dependent variable price and independent variable bedrooms
t.test(price,bedrooms,data = house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.1"
# Perform t Test on dependent variable price and independent variable bathrooms
t.test(price,bathrooms,data=house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.2"
# Perform t Test on dependent variable price and independent variable floors
t.test(price,floors,data=house_prices) # Output saved in "Forschungsfrage.docx" in section "Nullhypothese 3.2"
summary(house_prices_sqmt)
install.packages("corrplot")
library(corrplot)
subset_house_prices_sqmt <- subset(house_prices, select = c(price,
bedrooms,
bathrooms,
floors,
view,
yr_built,
yr_renovated,
lat,
long,
sqmt_living,
sqmt_living15,
sqmt_lot,
sqmt_lot15,
sqmt_above,
sqmt_basement))
?subse
cor_matrix <- cor(subset_house_prices_sqmt[1:15])
cor(subset_house_prices_sqmt[1:15])
cor(lat,price)
cor(price,bathrooms)
corrplot(cor_matrix,type="upper")
inspect(house_prices_sqmt)
View(house_prices_sqmt)
?cor
